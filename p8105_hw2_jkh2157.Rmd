---
title: "p8105_hw2_jkh2157"
output: github_document
date: "2025-09-30"
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## Loading Libraries 

```{r}
library(tidyverse)
library(knitr)
library(readxl)
```

## Problem 1

Step 1a: Clean the data in pols-month

```{r}
pols_df=
  read_csv("datasets/fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate (mon, into = c("year","month","day"),sep="-") %>% 
  mutate(
    month = recode(month,`01`="Jan",`02`="Feb",`03`="Mar",`04`="Apr",`05`="May",`06`="Jun",`07`="Jul",`08`="Aug",`09`="Sep",`10`="Oct",`11`="Nov",`12`="Dec"),
    president = case_when(
      prez_gop == 1 ~ "gop",
      prez_dem ==1 ~ "dem"
    ),
    year=as.character(year)
  ) %>% 
  select(year,month,president,everything(),-day,-prez_gop,-prez_dem)
knitr::kable(head(pols_df,10))
```

Step 1b: Clean the data for snp.csv 

```{r}
snp_df=
  read_csv("datasets/fivethirtyeight_datasets/snp.csv") %>% 
  separate(date, into=c("month","date","year"), sep = "/") %>% 
  mutate(
    month = recode(month,`1`="Jan",`2`="Feb",`3`="Mar",`4`="Apr",`5`="May",`6`="Jun",`7`="Jul",`8`="Aug",`9`="Sep",`10`="Oct",`11`="Nov",`12`="Dec"),
    year=case_when(
      as.numeric(year)>=50 ~ paste0("19",year),
      as.numeric(year)<50 ~ paste0("20",year)
    )) %>% 
  mutate(year=as.character(year)) %>% 
  select(year,month,close) %>% 
  arrange(year,month)
knitr::kable(head(snp_df,10))
```

Step 1c: tidy unemploymeny data 

```{r}
unemployment_df=
  read_csv("datasets/fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    cols=jan:dec,
    names_to="month",
    values_to="unemployment") %>% 
  mutate(
    month=str_to_title(month),
    year=as.character(year)) %>% 
  select(year,month,unemployment)
knitr::kable(head(unemployment_df,10))
```

Step 1d: merge data sets 

```{r}
final_df=left_join(pols_df,snp_df,by=c("year","month"))
final_df=left_join(final_df,unemployment_df,by=c("year","month"))
knitr::kable(head(final_df,15))
```

The pols data set (822 rows and 9 columns) contains the monthly counts of Democratic and Republican governors,senators, and representatives. The snp data set (787 rows and 3 columns) looks at the monthly closing values of the S&P index, starting in 1950 which explains why there are some NA values. The unemployment data set (816 rows and 3 columns) reports monthly US unemployment rates starting in 1948. After cleaning and merging these data sets we get a new frame that ranges from Jan 1947 to Jun 2015, with variables including year, month, president, congressional bodies, stock market performance (close), and unemployment rates. The dimensions of the final table contains 822 rows and 11 columns.

## Problem 2 

Step 2a: Cleaning up mrTrash

```{r}
mr_trash_df=
  read_excel("datasets/trash_wheel_data.xlsx", sheet="Mr. Trash Wheel", range = "A2:N655") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
mutate(
  sports_balls=as.integer(round(sports_balls)),
  identity = "mr",
  year=as.numeric(year)
)
knitr::kable(head(mr_trash_df,10))
```

Step 2b: Cleaning up Professor Trash 

```{r}
prof_trash_df=
  read_excel("datasets/trash_wheel_data.xlsx", sheet="Professor Trash Wheel", range="A2:M123") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(
    identity="prof",
    year=as.numeric(year)
  )
knitr::kable(head(prof_trash_df,10))
```

Step 2c: Cleaning up Gwynnda data 

```{r}
gwyn_trash_df=
  read_excel("datasets/trash_wheel_data.xlsx", sheet="Gwynnda Trash Wheel", range = "A2:L266") %>% 
  janitor::clean_names() %>% 
  filter(!is.na(dumpster)) %>% 
  mutate(
    identity="gwynnda",
    year=as.numeric(year)
  )
knitr::kable(head(gwyn_trash_df,10))
```


