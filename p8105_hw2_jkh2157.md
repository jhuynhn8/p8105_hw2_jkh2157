p8105_hw2_jkh2157
================
2025-09-30

## Loading Libraries

``` r
library(tidyverse)
```

    ## ── Attaching core tidyverse packages ──────────────────────── tidyverse 2.0.0 ──
    ## ✔ dplyr     1.1.4     ✔ readr     2.1.5
    ## ✔ forcats   1.0.0     ✔ stringr   1.5.1
    ## ✔ ggplot2   3.5.2     ✔ tibble    3.3.0
    ## ✔ lubridate 1.9.4     ✔ tidyr     1.3.1
    ## ✔ purrr     1.1.0     
    ## ── Conflicts ────────────────────────────────────────── tidyverse_conflicts() ──
    ## ✖ dplyr::filter() masks stats::filter()
    ## ✖ dplyr::lag()    masks stats::lag()
    ## ℹ Use the conflicted package (<http://conflicted.r-lib.org/>) to force all conflicts to become errors

``` r
library(knitr)
```

## Problem 1

Step 1a: Clean the data in pols-month

``` r
pols_df=
  read_csv("datasets/fivethirtyeight_datasets/pols-month.csv") %>% 
  janitor::clean_names() %>% 
  separate (mon, into = c("year","month","day"),sep="-") %>% 
  mutate(
    month = recode(month,`01`="Jan",`02`="Feb",`03`="Mar",`04`="Apr",`05`="May",`06`="Jun",`07`="Jul",`08`="Aug",`09`="Sep",`10`="Oct",`11`="Nov",`12`="Dec"),
    president = case_when(
      prez_gop == 1 ~ "gop",
      prez_dem ==1 ~ "dem"
    ),
    year=as.character(year)
  ) %>% 
  select(year,month,president,everything(),-day,-prez_gop,-prez_dem)
```

    ## Rows: 822 Columns: 9
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl  (8): prez_gop, gov_gop, sen_gop, rep_gop, prez_dem, gov_dem, sen_dem, r...
    ## date (1): mon
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
knitr::kable(head(pols_df,10))
```

| year | month | president | gov_gop | sen_gop | rep_gop | gov_dem | sen_dem | rep_dem |
|:-----|:------|:----------|--------:|--------:|--------:|--------:|--------:|--------:|
| 1947 | Jan   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |
| 1947 | Feb   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |
| 1947 | Mar   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |
| 1947 | Apr   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |
| 1947 | May   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |
| 1947 | Jun   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |
| 1947 | Jul   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |
| 1947 | Aug   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |
| 1947 | Sep   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |
| 1947 | Oct   | dem       |      23 |      51 |     253 |      23 |      45 |     198 |

Step 1b: Clean the data for snp.csv

``` r
snp_df=
  read_csv("datasets/fivethirtyeight_datasets/snp.csv") %>% 
  separate(date, into=c("month","date","year"), sep = "/") %>% 
  mutate(
    month = recode(month,`1`="Jan",`2`="Feb",`3`="Mar",`4`="Apr",`5`="May",`6`="Jun",`7`="Jul",`8`="Aug",`9`="Sep",`10`="Oct",`11`="Nov",`12`="Dec"),
    year=case_when(
      as.numeric(year)>=50 ~ paste0("19",year),
      as.numeric(year)<50 ~ paste0("20",year)
    )) %>% 
  mutate(year=as.character(year)) %>% 
  select(year,month,close) %>% 
  arrange(year,month)
```

    ## Rows: 787 Columns: 2
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## chr (1): date
    ## dbl (1): close
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
knitr::kable(head(snp_df,10))
```

| year | month | close |
|:-----|:------|------:|
| 1950 | Apr   | 17.96 |
| 1950 | Aug   | 18.42 |
| 1950 | Dec   | 20.43 |
| 1950 | Feb   | 17.22 |
| 1950 | Jan   | 17.05 |
| 1950 | Jul   | 17.84 |
| 1950 | Jun   | 17.69 |
| 1950 | Mar   | 17.29 |
| 1950 | May   | 18.78 |
| 1950 | Nov   | 19.51 |

Step 1c: tidy unemploymeny data

``` r
unemployment_df=
  read_csv("datasets/fivethirtyeight_datasets/unemployment.csv") %>% 
  janitor::clean_names() %>% 
  pivot_longer(
    cols=jan:dec,
    names_to="month",
    values_to="unemployment") %>% 
  mutate(
    month=str_to_title(month),
    year=as.character(year)) %>% 
  select(year,month,unemployment)
```

    ## Rows: 68 Columns: 13
    ## ── Column specification ────────────────────────────────────────────────────────
    ## Delimiter: ","
    ## dbl (13): Year, Jan, Feb, Mar, Apr, May, Jun, Jul, Aug, Sep, Oct, Nov, Dec
    ## 
    ## ℹ Use `spec()` to retrieve the full column specification for this data.
    ## ℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.

``` r
knitr::kable(head(unemployment_df,10))
```

| year | month | unemployment |
|:-----|:------|-------------:|
| 1948 | Jan   |          3.4 |
| 1948 | Feb   |          3.8 |
| 1948 | Mar   |          4.0 |
| 1948 | Apr   |          3.9 |
| 1948 | May   |          3.5 |
| 1948 | Jun   |          3.6 |
| 1948 | Jul   |          3.6 |
| 1948 | Aug   |          3.9 |
| 1948 | Sep   |          3.8 |
| 1948 | Oct   |          3.7 |

Step 1d: merge data sets

``` r
final_df=left_join(pols_df,snp_df,by=c("year","month"))
final_df=left_join(final_df,unemployment_df,by=c("year","month"))
knitr::kable(head(final_df,15))
```

| year | month | president | gov_gop | sen_gop | rep_gop | gov_dem | sen_dem | rep_dem | close | unemployment |
|:---|:---|:---|---:|---:|---:|---:|---:|---:|---:|---:|
| 1947 | Jan | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Feb | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Mar | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Apr | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | May | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Jun | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Jul | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Aug | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Sep | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Oct | dem | 23 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Nov | dem | 24 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1947 | Dec | dem | 24 | 51 | 253 | 23 | 45 | 198 | NA | NA |
| 1948 | Jan | dem | 22 | 53 | 253 | 24 | 48 | 198 | NA | 3.4 |
| 1948 | Feb | dem | 22 | 53 | 253 | 24 | 48 | 198 | NA | 3.8 |
| 1948 | Mar | dem | 22 | 53 | 253 | 24 | 48 | 198 | NA | 4.0 |

The pols data set contains the monthly counts of Democratic and
Republican governors,senators, and representatives. The snp data set
looks at the monthly closing values of the S&P index, starting in 1950
which explains why there are some NA values. The unemployment data set
reports monthly US unemployment rates starting in 1948. After cleaning
and merging these data sets we get a new frame that ranges from Jan 1947
to Jun 2015, with variables including year, month, president,
congressional bodies, stock market performance (close), and unemployment
rates. The dimensions of the final table contains 822 rows and 11
columns.
